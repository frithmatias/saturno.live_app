<div class="animated fadeIn" style="min-width: 18rem; max-width: 30rem;">

  <!-- STEPPER OFF -->
  <div *ngIf="!showIntro">
    <div class="jumbotron m-2 animated fadeIn">
      <h3 class="mb-4">Bienvenido {{ userService?.user.tx_name }}!</h3>

      <button class="btn btn-primary btn-block btn-lg" routerLink="/assistant/home">Atender</button>

      <hr class="my-4">

      <div *ngIf="userService.user.id_company" class="card bg-danger text-white">
        <div class="card-body" style="text-align: left;">

          <div>
            <p>
              <mat-icon style="vertical-align: sub;">headset_mic</mat-icon> Atender Turnos
            </p>
            <p>
              Para atender turnos sólo debe ingresar a su cuenta y luego ir al menú de Asistente y tomar un escritorio.
            </p>

          </div>
          <hr>
          <div>
            <p>
              <mat-icon style="vertical-align: sub;">bookmark_border</mat-icon> Generar Turnos
            </p>
            <p>
              Para que sus clientes puedan crear turnos de su comercio o empresa, debe ofrecerles la
              dirección web principal en saturno.live, ir a "OBTENER TURNO" y allí buscar su empresa por su nombre.
            </p>
            <p>
              <a target="_blank" href="https://saturno.live">
                https://saturno.live
              </a>
            </p>
          </div>
          <hr>
          <p>
            <mat-icon style="vertical-align: sub;">language</mat-icon> Acceso directo a crear turnos
          </p>
          <p>
            La dirección web de acceso directo a el panel de turnos de su comercio es:
          </p>
          <p>
            <a target="_blank" href="https://saturno.live/#/public/{{userService.user.id_company.tx_public_name}}">
              https://saturno.live/#/public/{{userService.user.id_company.tx_public_name}}
            </a>
          </p>
        </div>
      </div>
    </div>
  </div>


  <!-- STEPPER ON -->
  <mat-horizontal-stepper style="text-align: left;" *ngIf="showIntro" labelPosition="bottom" linear #stepper>

    <!-- Welcome Step -->
    <mat-step state="star">
      <div class="jumbotron m-2 animated fadeIn">
        <div class="card-body">
          <h3>Hola {{ userService?.user.tx_name }}!</h3>

          <p>
            Para comenzar a atender turnos debe crear, al menos un comercio, al menos un escritorio y al menos una
            habilidad
          </p>
          <p>
            Opcionalmente puede dar de alta asistentes. No le llevará mas de un minuto y desde aquí puede hacer todo!.
          </p>
          <hr>
          <button class="btn btn-success" matStepperNext>Comenzar</button>
          <qrcode [qrdata]="'Your data string'" [width]="256" [errorCorrectionLevel]="'M'"></qrcode>
        </div>
      </div>
    </mat-step>

    <!-- Company Step -->
    <mat-step [completed]="userService.companies?.length > 0 && userService.user?.id_company?._id" state="store">

      <div class="card m-2" style="min-width: 18rem; max-width: 30rem;">
        <div class="card-header">Crear Empresas / Comercios</div>
        <div class="card-body">

          <!-- no companies, no attached company -->
          <div *ngIf="userService.companies?.length === 0">
            <h3>Comencemos</h3>
            <p>
              Usted no tiene ningún comercio registrado, desde aquí usted debe registrar al menos un comercio.
            </p>
            <hr>
            <p>
              Es importante que usted ingrese la dirección exacta. Esta dirección será visible para sus clientes
              desde el menú público de turnos y le asegura a su cliente que esta obteniendo un turno en el comercio
              correcto.
            </p>
          </div>

          <!-- companies, but not attached company -->
          <div *ngIf="userService.companies?.length > 0 && !userService.user?.id_company?._id">
            <h3>Comercio creado!</h3>
            <hr>
            <p class="card-text card-text">
              Ya tiene creado al menos un comercio.
              Para continuar es necesario que lo seleccione desde el menu principal.
            </p>
            <img src="assets/img/saturno-selector-empresas.png">
          </div>

          <!-- companies and attached company -->
          <div *ngIf="userService.companies?.length > 0 && userService.user?.id_company?._id">

            <h3>Perfecto! <mat-icon style="color:green">check</mat-icon>
            </h3>
            <p>
              Las habilidades, escritorios y asistentes que registre a partir de ahora, serán
              asignados a
              <span style="color:blue;">
                {{userService.user.id_company.tx_company_name}}
              </span>
            </p>
            <hr>
            <p>
              Usted puede crear mas comercios si dispone de sucursales.
            </p>
          </div>

          <!-- previous / next -->
          <div class="row mx-2 mt-4" style="justify-content: space-between;">
            <button class="btn btn-danger col-5" matStepperPrevious> Volver </button>
            <button class="btn btn-success col-5"
              [disabled]="!userService.companies || !userService.user?.id_company?._id" matStepperNext> Siguiente
            </button>
          </div>

        </div>

      </div>

      <app-companies></app-companies>
    </mat-step>

    <!-- Skills Step -->
    <mat-step [completed]="userService.skills?.length > 0" state="playlist_add_check">

      <div class="card m-2" style="min-width: 18rem; max-width: 30rem;">
        <div class="card-header">Crear Skills / Habilidades</div>
        <div class="card-body">
          <h3>Habilidades (opcional)</h3>
          <p>
            Este paso es opcional. Si no necesita mas de una línea de turnos puede omitir este paso y continuar. 
            Por defecto esta opción esta desactivada.
          </p>
          <hr>
          <div class="p-1 mb-3" style="cursor: pointer;" (click)="activateSkillExplanation=!activateSkillExplanation">
            ¿Que son los skills? (habilidades)
          </div>
          <div *ngIf="activateSkillExplanation" class="animated fadeIn">
            <p>
              Al crear su comercio, una habilidad genérica para su comercio fue creada y asignada por defecto a su usuario.
            </p>
            <p>
              Sin embargo usted puede habilitar la opción de skills si su comercio tiene diferentes segmentos 
              que requieren diferentes habilidades de atención. 
            </p>
            <p>
              Por ejemplo si usted quiere generar turnos para una guardia, podría necesitar generar las habilidades
              de "Pediatría", "Clínica" y "Traumatología" con las abreviaturas como P, C y T respectivamente.
            </p>
            <p>
              Con las habilidades usted puede además definir circuitos de atención. Puede recibir un turno que fué 
              atendido en un escritorio con skill A y enviarlo luego para ser atendido a un escritorio con skill B, 
              y así sucesivamente. Al reasignar un turno tamién puede establecer su prioridad de modo de enviarlo 
              al inicio o al fin de la cola de espera.
            </p>
            <p>
              Las habilidades se asignan a los asistentes al momento de crearlos. Puede asignar una o mas habilidades por 
              asistente. Su usuario tiene rol de administrador y tendrá asignadas todas las habilidades de atención.
            </p>

          </div>

          <div class="row mx-2 mt-4" style="justify-content: space-between;">
            <button class="btn btn-danger col-5" matStepperPrevious> Volver </button>
            <button [disabled]="userService.skills?.length === 0 " class="btn btn-success col-5" matStepperNext>
              Siguiente </button>
          </div>
        </div>
      </div>

      <app-skills></app-skills>
    </mat-step>

    <!-- Desktops Step -->
    <mat-step [completed]="userService.desktops?.length > 0" state="important_devices">

      <div class="card m-2" style="min-width: 18rem; max-width: 30rem;">
        <div class="card-header">Crear Ventanillas / Escritorios</div>
        <div class="card-body">
          <h3>Escritorios</h3>

          <p>
            Los escritorios sólo necesitan un identificador que es simplemente una etiqueta. Estos
            identificadores pueden ser letras o números por ejemplo
          </p>
          <p>
            "1", "2", "A", "B"
          </p>
          <hr>
          <p>
            Este identificador debe colocarlo en cada escritorio de forma bien visible para que su cliente
            pueda identificar fácilmente el escritorio desde el cual fue llamado.
          </p>
          <div class="row mx-2 mt-4" style="justify-content: space-between;">
            <button class="btn btn-danger col-5" matStepperPrevious> Volver </button>
            <button [disabled]="userService.desktops?.length === 0" class="btn btn-success col-5" matStepperNext>
              Siguiente </button>
          </div>
        </div>
      </div>

      <app-desktops></app-desktops>
    </mat-step>

    <!-- Assistants Step -->
    <mat-step [completed]="userService.assistants.length > 1 || userService.user.id_skills.length > 0" state="face">

      <div class="card m-2" style="min-width: 18rem; max-width: 30rem;">
        <div class="card-header">Crear Asistentes / Operadores</div>
        <div class="card-body">
          <h3>Asistentes (opcional)</h3>
          <p>
            Este paso es opcional. Si sólo necesita su propio usuario para atender turnos puede
            omitir este paso y continuar.
          </p>
          <hr>
          <div class="p-1 mb-3" style="cursor: pointer;" (click)="activateAssistantExplanation=!activateAssistantExplanation">
            ¿Que son los asistentes?
          </div>
          <div *ngIf="activateAssistantExplanation" class="animated fadeIn">
            <p>
              Usted como usuario puede atender turnos desde el menú de Asistentes. Sin embargo puede
              opcionalmente crear otros usuarios con rol de asistente para la tarea de atender turnos.
            </p>
            <p>
              Si fueron creadas habilidades deberá asignarle a cada asistente las habilidades que le correspondan.
            </p>
            <p>
              Tenga en cuenta que los asistentes que usted puede crear aquí, deben ingresar a sus cuentas desde el mismo login
              de usuario pero con la opción [ENTRAR] con su email y contraseña.
            </p>
          </div>

          <div *ngIf="userService.assistants.length === 1 && userService.user.id_skills.length === 0"
            class="card bg-danger p-3 text-white">
            Usted no tiene asistentes creados ni habilidades asociadas a su usuario.
            <hr>
            <p>
              Usted puede crear asistentes y asignarles habilidades, o puede omitir crear asistentes, pero en ese caso
              debe al menos asignarse a su propio usuario las habilidades que quiere atender. Para eso
              edite su usuario haciendo click en editar con el icono
              <mat-icon style="font-size: medium;">edit</mat-icon> y luego selecciones las habilidades en el cuadro
              SKILLS.
            </p>

          </div>


          <div class="row mx-2 mt-4" style="justify-content: space-between;">
            <button class="btn btn-danger col-5" matStepperPrevious> Volver </button>
            <button [disabled]="userService.assistants.length === 1 && userService.user.id_skills.length === 0"
              class="btn btn-primary col-5" routerLink="/admin/home" (click)="endWizard()"> Finalizar </button>
          </div>
        </div>
      </div>

      <app-assistants></app-assistants>
    </mat-step>

  </mat-horizontal-stepper>

  <div class="m-2">
    <mat-slide-toggle [(ngModel)]="showIntro" (click)="toggleIntro()"> Ver intoducción </mat-slide-toggle>
  </div>

</div>