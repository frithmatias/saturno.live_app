<!-- ======================================================== -->
<!-- TICKETS SCREEN -->
<!-- ======================================================== -->

<div class="row p-2 animated fadeIn">

    <div class="col-md-6" style="min-width: 18rem;">

        <!-- ======================================================== -->
        <!-- TICKET FINALIZADO -->
        <!-- ======================================================== -->
        <!-- *ngIf="!ticketsService.myTicket && ticketsService.myTicketEnd!==null" -->
        <div *ngIf="ticketsService.myTicketEnd!==null" class="card text-white bg-danger mb-4">
            <div class="card-header banner-title">SU OPINION</div>
            <div class="banner-content p-3" style="background-color: rgb(141, 51, 51)">

                <div>¡Su turno ha finalizado!</div>
                <div class="lead my-2">Lo invitamos a valorar la atención recibida.</div>

                <div class="text-white my-4 table-responsive-sm">
                    <table class="table table-sm text-white">
                        <tr *ngFor="let ticket of ticketsService.allMytickets">
                            <td class="py-2" style="width: 50%;text-align: left;">
                                {{ ticket.id_skill?.tx_skill }}
                            </td>
                            <td class="py-2">
                                <mat-icon class="screen-icon-star"
                                    [ngClass]="{'screen-icon-star-on': scores.get(ticket._id) >= 1}"
                                    (click)="setScore(ticket._id, 1)">star</mat-icon>
                            </td>
                            <td class="py-2">
                                <mat-icon class="screen-icon-star"
                                    [ngClass]="{'screen-icon-star-on': scores.get(ticket._id) >= 2}"
                                    (click)="setScore(ticket._id, 2)">star</mat-icon>
                            </td>
                            <td class="py-2">
                                <mat-icon class="screen-icon-star"
                                    [ngClass]="{'screen-icon-star-on': scores.get(ticket._id) >= 3}"
                                    (click)="setScore(ticket._id, 3)">star</mat-icon>
                            </td>
                            <td class="py-2">
                                <mat-icon class="screen-icon-star"
                                    [ngClass]="{'screen-icon-star-on': scores.get(ticket._id) >= 4}"
                                    (click)="setScore(ticket._id, 4)">star</mat-icon>
                            </td>
                            <td class="py-2">
                                <mat-icon class="screen-icon-star"
                                    [ngClass]="{'screen-icon-star-on': scores.get(ticket._id) >= 5}"
                                    (click)="setScore(ticket._id, 5)">star</mat-icon>
                            </td>
                        </tr>
                    </table>
                </div>


            </div>
        </div>

        <!-- ======================================================== -->
        <!-- SU TURNO -->
        <!-- ======================================================== -->

        <div class="card text-white bg-success mb-4" *ngIf="ticketsService.myTicket && ticketsService.myTicketEnd===null">
            <div class="card-header banner-title">SU TURNO</div>
            <div class="banner-content" style="background-color: rgb(51, 141, 51)">

                <!------------------------------>
                <!-- EN ESPERA -->
                <!------------------------------>

                <div *ngIf="!ticketsService.myTicket?.id_desk">
                    <span class="xxxxl">
                        {{ ticketsService.myTicket?.id_skill.cd_skill }}
                        {{ ticketsService.myTicket?.cd_number }}
                    </span>
                </div>

                <!------------------------------>
                <!-- EN ATENCIÓN -->
                <!------------------------------>

                <div class="banner-content" *ngIf="ticketsService.myTicket?.id_desk">
                    <div class="row">
                        <div class="col">
                            Por favor pase por el escritorio
                        </div>
                    </div>
                    <div class="row">
                        <div class="col xxxxl">
                            {{ ticketsService.myTicket?.id_desk?.cd_desktop }}
                        </div>
                    </div>
                </div>

                <!------------------------------>
                <!-- FINALIZADO -->
                <!------------------------------>


            </div>
        </div>


        <!-- ======================================================== -->
        <!-- ULTIMO TURNO -->
        <!-- ======================================================== -->

        <div class="card text-white bg-danger mb-4">
            <div class="card-header banner-title">ULTIMO TURNO</div>
            <div class="banner-content" style="background-color: rgb(141, 51, 51)">

                <div *ngIf="!ticketsService.lastTicket">
                    <span class="xxxxl">
                        --
                        --
                    </span>
                </div>
                <div>
                    <span class="xxxxl">
                        {{ ticketsService.lastTicket?.id_skill.cd_skill }}
                        {{ ticketsService.lastTicket?.cd_number }}
                    </span>
                </div>

            </div>
        </div>

        <!-- ======================================================== -->
        <!-- PUBLICIDAD -->
        <!-- ======================================================== -->

        <div>
            <!-- <iframe width="100%" height="480px" [src]="'-FV0KKDdysw?rel=0&autoplay=1&mute=0&fullscreen=1&loop=1&playlist=-FV0KKDdysw' | domseguro: 'https://www.youtube.com/embed/'" frameborder="0" allowtransparency="true" allow="accelerometer; autoplay; loop; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> -->
        </div>

    </div>

    <div class="col-md-6" style="min-width: 18rem;">

        <!-- ======================================================== -->
        <!-- HISTORIAL DE LLAMADAS -->
        <!-- ======================================================== -->

        <div class="card text-white bg-primary mb-4">
            <div class="card-header banner-title">HISTORIAL</div>

            <div class="card-body card-tickets-info table-responsive-sm" style="background-color: rgb(54, 77, 194)">

                <table class="table table text-white text-center" style="font-size: x-large;">

                    <tr>
                        <td> Turno </td>
                        <td> Escritorio</td>
                        <td> Estado </td>
                    </tr>
                    <tr *ngIf="ticketsService.ticketsTail.length === 0">
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr *ngFor="let ticket of ticketsService.ticketsTail;">
                        <td style="text-align: center;">
                            {{ ticket.id_skill.cd_skill }}{{ ticket.cd_number }}</td>

                        <td style="text-align: center; ">{{ ticket.id_desk.cd_desktop }}</td>

                        <td style="padding: 0; vertical-align: middle;">
                            <span *ngIf="!ticket.tm_end" style="color: greenyellow">
                                <mat-icon style="font-size: xx-large;">campaign</mat-icon>
                            </span>
                            <span *ngIf="ticket.id_child && ticket.tm_end" style="color: greenyellow">
                                <mat-icon style="font-size: xx-large;">replay</mat-icon>
                            </span>
                            <span *ngIf="!ticket.id_child && ticket.tm_end" style="color: greenyellow">
                                <mat-icon style="font-size: xx-large;">check</mat-icon>
                            </span>
                        </td>
                    </tr>

                </table>

            </div>
        </div>

    </div>

</div>

<!-- ======================================================== -->
<!-- PUBLIC BUTTONS -->
<!-- ======================================================== -->

<div class="row">
    <div class="col">

        <div *ngIf="ticketsService.myTicket" class="text-center footer-panel">
            <button class="btn btn-danger text-uppercase m-2" (click)="cancelTicket()">Cancelar Turno</button>
            <button [disabled]="!ticketsService.myTicket?.id_desk || coming" class="btn btn-success text-uppercase m-2"
                (click)="enCamino()">en camino</button>
        </div>

    </div>
</div>